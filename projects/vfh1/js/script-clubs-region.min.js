(function () {
   // header scroll
   const body = document.body;
  //  const triggerMenu = document.querySelector(".page-header__btn-burger");

   const scrollUp = "scroll-up";
   const scrollDown = "scroll-down";
   let lastScroll = 0;

  //  triggerMenu.addEventListener("click", () => {
  //    body.classList.toggle("menu-open");
  //    triggerMenu.classList.toggle("active");
  //  });

   window.addEventListener("scroll", () => {
     const currentScroll = window.pageYOffset;
     if (currentScroll <= 0) {
       body.classList.remove(scrollUp);
       return;
     }

     if (currentScroll > lastScroll && !body.classList.contains(scrollDown)) {
       // down
       body.classList.remove(scrollUp);
       body.classList.add(scrollDown);
     } else if (currentScroll < lastScroll && body.classList.contains(scrollDown)) {
       // up
       body.classList.remove(scrollDown);
       body.classList.add(scrollUp);
     }
     lastScroll = currentScroll;
   });
})()

// mob menu

export let mobileMenuToggle = () => {
  const page = document.querySelector('.page');
  const btnMenuOpen = document.querySelector('.page-header__btn-menu');
  const btnMenuOpenClose = document.querySelector('.mobile-menu__btn-close');
  const headerTop = document.querySelector('.page-header');
  const mobMenu = document.querySelector('.mobile-menu');

  if (btnMenuOpen) {
    btnMenuOpen.addEventListener('click', function() {
      headerTop.classList.add('page-header--mob');
      page.classList.add('page--overlay');
      mobMenu.classList.add('active');
    });
  }

  if (btnMenuOpenClose) {
    btnMenuOpenClose.addEventListener('click', function() {
      headerTop.classList.remove('page-header--mob');
      page.classList.remove('page--overlay');
      mobMenu.classList.remove('active');
    });
  }

  if (mobMenu) {
    mobMenu.addEventListener('click', () => {
      mobMenu.classList.remove('active');
    });
  }

  window.onresize = function() {
    if (window.screen.width > 768) {
      document.querySelector('.page').classList.remove('page--overlay');
      if (headerTop.classList.contains('page-header--mob')) {
        headerTop.classList.remove('page-header--mob');
      }
    }
  };
};



mobileMenuToggle();



(function() {
  const cities = [
    'Санкт-Петербург',
    'Нижний Новгород',
    'Казань',
    'Тольятти',
    'Самара',
    'Ульяновск',
    'Архангельск',
    'Ижевск',
    'Ярославль',
    'Петрозаводск',
    'Мурманск',
    'Рязань',
    'Набережные Челны',
    'Тула',
    'Нижнекамск',
  ];

  let listCity = cities.filter(item => item !== 'Санкт-Петербург');
  let sortCities = listCity.sort();
  sortCities.unshift('Санкт-Петербург');

  let items = [...document.querySelectorAll('.city-list li button')];
  let navItems = [...document.querySelectorAll('.nav-city__list li a')];

  for (let j = 0; j < sortCities.length; j++) {
    for (let i = 0; i < items.length; i++) {
      if (i == j) {
        items[i].innerText = sortCities[j];
      }
    }
    for (let i = 0; i < navItems.length; i++) {
      if (i == j) {
        navItems[i].innerText = sortCities[j];
      }
    }
  }

   let navCityToggle = () => {
    const city = document.querySelector('.nav-city__title');
    const cityName = document.querySelector('.nav-city__title span');
    const cityList = document.querySelector('.nav-city__wrapper');
    const cityListOpen = document.querySelector('.nav-city__wrapper.d-block');

    const toggleMenuCity = () => {
      cityList.classList.toggle('d-block');
      cityList.classList.toggle('d-none');
    };

    if (city) {
      city.addEventListener('click', evt => {
        evt.stopPropagation();
        toggleMenuCity();
      });
    }

    document.addEventListener('click', evt => {
      let target = evt.target;
      let its_menu = target == cityList || cityList.contains(target);
      let its_hamburger = target == city;
      let menu_is_active = cityList.classList.contains('d-block');

      if (!its_menu && !its_hamburger && menu_is_active) {
        toggleMenuCity();
      }
    });

    if (cityList) {
      cityList.addEventListener('click', evt => {
        evt.preventDefault();
        let target = evt.target.tagName;
        if (target == 'A') {
          let activeNameCity = evt.target.innerText;
          cityName.innerText = activeNameCity;
          toggleMenuCity();
        }
      });
    }

    if (cityListOpen) {
      console.log('open');
      page.addEventListener('click', () => {
        console.log(evt.target);
        toggleMenuCity();
      });
    }
  };

  document.addEventListener('DOMContentLoaded', navCityToggle);
})();

// Example starter JavaScript for disabling form submissions if there are invalid fields
(function() {
  'use strict';

  // Fetch all the forms we want to apply custom Bootstrap validation styles to
  let forms = document.querySelectorAll('.needs-validation');
  let modalTour = document.querySelector('.modal-tour');
  let modalSubmitForm = document.getElementById('modal-submit-form');

  // document.addEventListener('DOMContentLoaded', () => {

  // });


  if (modalTour) {
    const modal = new bootstrap.Modal(modalTour);
    Array.prototype.slice.call(forms).forEach(function(form) {
      form.addEventListener(
        'submit',
        function(event) {
          if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
            form.classList.add('was-validated');
          } else {
            event.preventDefault();
            form.classList.remove('was-validated');
            const modalSubmit = new bootstrap.Modal(modalSubmitForm);

            modal.hide();
            modalSubmit.show();

            modalSubmitForm.addEventListener('hidden.bs.modal', function() {
              form.submit();
              form.reset();
            });
          }
        },
        false,
      );
    });
  } else {
    Array.prototype.slice.call(forms).forEach(function(form) {
      form.addEventListener(
        'submit',
        function(event) {
          if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
            form.classList.add('was-validated');
          } else {
            event.preventDefault();
            form.classList.remove('was-validated');
            const modalSubmit = new bootstrap.Modal(modalSubmitForm);
            modalSubmit.show();

            modalSubmitForm.addEventListener('hidden.bs.modal', function() {
              form.submit();
              form.reset();
            });
          }
        },
        false,
      );
    });
  }

  // Loop over them and prevent submission
  // Array.prototype.slice.call(forms).forEach(function(form) {
  //   form.addEventListener(
  //     'submit',
  //     function(event) {
  //       if (!form.checkValidity()) {
  //         event.preventDefault();
  //         event.stopPropagation();
  //         form.classList.add('was-validated');
  //       } else {
  //         event.preventDefault();
  //         form.classList.remove('was-validated');
  //         const modalSubmit = new bootstrap.Modal(modalSubmitForm);

  //         if (modalTour) {
  //           let modal = new bootstrap.Modal(modalTour);
  //           modal.hide();
  //           modalSubmit.show();
  //         } else {
  //           modalSubmit.show();
  //         }

  //         modalSubmitForm.addEventListener('hidden.bs.modal', function() {
  //           form.submit();
  //           form.reset();
  //         });
  //       }
  //     },
  //     false,
  //   );
  // });

  // маска для телефона
  let phones = document.querySelectorAll('input[type="tel"]');
  phones.forEach(phone => {
    let maskOptions = {
      mask: '{8} (000)000-00-00',
      lazy: true,
      autofix: true, // bound value
      placeholderChar: '9',
    };
    new IMask(phone, maskOptions);
  });
})();


// Пример реализации боковой панели на основе наследования от collection.Item.
// Боковая панель отображает информацию, которую мы ей передали.
ymaps.modules.define('Panel', ['util.augment', 'collection.Item'], function(
  provide,
  augment,
  item,
) {
  // Создаем собственный класс.
  var Panel = function(options) {
    Panel.superclass.constructor.call(this, options);
  };

  // И наследуем его от collection.Item.
  augment(Panel, item, {
    onAddToMap: function(map) {
      Panel.superclass.onAddToMap.call(this, map);
      this.getParent()
        .getChildElement(this)
        .then(this._onGetChildElement, this);
      // Добавим отступы на карту.
      // Отступы могут учитываться при установке текущей видимой области карты,
      // чтобы добиться наилучшего отображения данных на карте.
      map.margin.addArea({
        top: 0,
        right: 0,
        width: '645px',
        height: '100%',
      });
    },

    onRemoveFromMap: function(oldMap) {
      if (this._$control) {
        this._$control.remove();
      }
      Panel.superclass.onRemoveFromMap.call(this, oldMap);
    },

    _onGetChildElement: function(parentDomContainer) {
      // Создаем HTML-элемент с текстом.
      // По-умолчанию HTML-элемент скрыт.
      this._$control = $(
        '<div class="customControl"><div class="content"></div><div class="closeButton"></div></div>',
      ).appendTo(parentDomContainer);
      this._$content = $('.content');
      // При клике по крестику будем скрывать панель.
      $('.closeButton').on('click', this._onClose);
    },
    _onClose: function() {
      $('.customControl').css('display', 'none');
    },
    // Метод задания контента панели.
    setContent: function(text) {
      // При задании контента будем показывать панель.
      this._$control.css('display', 'flex');
      this._$content.html(text);
    },
  });

  provide(Panel);
});

const clubs = [
  {
    id: 1,
    organizationID: '59424239124',
    title: 'На Политехнической',
    metro: ['Лесная'],
    address: 'ул. Политехническая д. 6',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.99338783655131, 30.357060207678387],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 2,
    organizationID: '188225841249',
    title: 'На Заречной',
    metro: ['Парнас'],
    address: 'Парнас, Заречная улица, д. 15, к. 1, стр. 1',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [60.07184387468895, 30.313293676211845],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 3,
    organizationID: '105869311645',
    title: 'Premier в Охта Молле',
    metro: ['Новочеркасская'],
    address: 'ТРЦ "Охта Молл", Брантовская дор., 3',
    pool: 'Без бассейна',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.940145, 30.418366],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 4,
    organizationID: '150992339797',
    title: 'В Янино',
    metro: ['Нет метро'],
    address: 'г. Санкт -Петербург ГП Янино 1, ул. Ветряных Мельниц д. 3/1',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.94647385079991, 30.578224164931893],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 5,
    organizationID: '231925353306',
    title: 'В Шушарах',
    metro: ['Купчино'],
    address: 'п.Шушары, Новгородский пр-т, д.6, к.2',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.809786088626005, 30.369441015215184],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 6,
    organizationID: '81459810090',
    title: 'На Камышовой',
    metro: ['Комендантский проспект', 'Старая деревня'],
    address: 'ул.Камышовая, 36 стр. 1',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [60.00871923103037, 30.221511823631502],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 7,
    organizationID: '145227486399',
    title: ['На Маршака'],
    metro: 'Гражданский проспект',
    address: 'пр.Маршака, д.10',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [60.03354276497513, 30.44671406561881],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 8,
    organizationID: '32265063318',
    title: 'В Славянке',
    metro: ['Нет метро'],
    address: 'Славянка, ул. Ростовская, д. 20',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.74261689649956, 30.47284553716527],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 9,
    organizationID: '61944806147',
    title: 'На Шаврова',
    metro: ['Комендантский проспект'],
    address: 'ул. Шаврова, д. 26',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [60.027326665933856, 30.241617931679027],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 10,
    organizationID: '135754332803',
    title: 'Premier на Салова',
    metro: ['Бухарестская'],
    address: 'ул. Салова, 61, строение 1',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.885320045648115, 30.368691489042046],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 11,
    organizationID: '186380737723',
    title: 'На Хасанской',
    metro: ['Проспект Большевиков'],
    address: 'Хасанская улица, 10, к2',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.938004, 30.482802],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 12,
    organizationID: '30145969104',
    title: 'На Наличной',
    metro: ['Приморская'],
    address: 'ул. Наличная, д. 44 к 1',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.952069, 30.232846],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 13,
    organizationID: '120393640904',
    title: 'В Мурино',
    metro: ['Девяткино'],
    address: 'г. Мурино, ул. Шувалова д.11',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [60.056786, 30.427547],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 14,
    organizationID: '211015871638',
    title: 'На Маршала Блюхера',
    metro: ['Выборгская'],
    address: 'пр. Маршала Блюхера, д. 9, к. 3',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.97812, 30.373351],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 15,
    organizationID: '29432887316',
    title: 'На Краснопутиловской',
    metro: ['Московская'],
    address: 'ул. Краснопутиловская, д. 111А',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.848854, 30.30764],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 16,
    organizationID: '170179942434',
    title: 'На Северном',
    metro: ['Академическая', 'Озерки'],
    address: 'Северный пр., д. 40, литер А',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [60.028748, 30.38679],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 17,
    organizationID: '1703370741',
    title: 'На Дальневосточном',
    metro: ['Улица Дыбенко'],
    address: 'ул. Крыленко, д. 14',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.894915, 30.463587],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 18,
    organizationID: '133283717174',
    title: 'На Большевиков',
    metro: ['Проспект Большевиков'],
    address: 'пр. Большевиков, д.7 к2',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.91544, 30.471178],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 19,
    organizationID: '8256075866',
    title: 'В Кудрово',
    metro: ['Улица Дыбенко'],
    address: 'г. Кудрово, Европейский пр. 21, стр.1, лит.В',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.910203, 30.514459],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 20,
    organizationID: '1707584609',
    title: 'На Ветеранов',
    metro: ['Проспект Ветеранов'],
    address: 'пр. Ветеранов, 121',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.83413, 30.171895],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 21,
    organizationID: '209286171278',
    title: 'На Стачек',
    metro: ['Кировский завод'],
    address: 'пр. Стачек 47, лит. Ж',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.88167971239858, 30.261754846617617],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 22,
    organizationID: '1470092606',
    title: 'На Фучика',
    metro: ['Бухарестская', 'Международная'],
    address: 'ул. Фучика, д. 2, лит. А',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.87721864510378, 30.359276584655753],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 23,
    organizationID: '1231719184',
    title: 'Prestige на Гашека',
    metro: ['Купчино'],
    address: 'ул. Я. Гашека, д. 17А',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.83541940978107, 30.40392540740968],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 24,
    organizationID: '1337056579',
    title: 'На Таллинском шоссе',
    metro: ['Проспект Ветеранов'],
    address: 'Таллинское шоссе, 25',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.794935, 30.145736],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 25,
    organizationID: '1404953624',
    title: 'На Маршала Говорова',
    metro: ['Кировский завод'],
    address: 'ул. Маршала Говорова, д. 35, к. 4',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.888803, 30.279828],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 26,
    organizationID: '1201615239',
    title: 'Prestige на Пулковском',
    metro: ['Звёздная', 'Московская'],
    address: 'Шереметьевская ул., 13 литера А',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–23:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.806695, 30.320432],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 27,
    organizationID: '21278922642',
    title: 'На Гашека',
    metro: ['Купчино'],
    address: 'ул. Я. Гашека, д. 17А',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.835225, 30.403625],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 28,
    organizationID: '1234036300',
    title: 'В Рыбацком',
    metro: ['Рыбацкое'],
    address: 'пер. Скачков, д. 5',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.831209, 30.506158],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 29,
    organizationID: '1268049265',
    title: 'На Выборгской наб.',
    metro: ['Лесная', 'Чёрная речка'],
    address: 'наб. Выборгская, д. 61',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.980583, 30.322534],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 30,
    organizationID: '41410792816',
    title: 'В Светлановском',
    metro: ['Удельная'],
    address: 'пр. Энгельса, д. 33, корп. 1, ТЦ "Светлановский"',
    pool: 'Без бассейна',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [60.00939, 30.326423],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 31,
    organizationID: '1172706920',
    title: 'На Бульваре Новаторов',
    metro: ['Ленинский проспект'],
    address: 'Бульвар Новаторов, д. 32',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.847774, 30.269704],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 32,
    organizationID: '121651303804',
    title: 'В Петергофе',
    metro: ['Нет метро'],
    address: 'пр. Санкт-Петербургский, д. 60',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.881724, 29.893938],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 33,
    organizationID: '1051065532',
    title: 'На Наставников',
    metro: ['Ладожская'],
    address: 'пр. Наставников, д. 24, к. 1',
    pool: 'Без бассейна',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.945779, 30.489243],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 34,
    organizationID: '1020314458',
    title: 'На Васильевском',
    metro: ['Василеостровская'],
    address: 'пр. Большой В.О., д. 68А',
    pool: 'Без бассейна',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.931864, 30.259984],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 35,
    organizationID: '1007528880',
    title: 'На Пражской',
    metro: ['Международная'],
    address: 'ул. Пражская, д. 30/2 A',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.871468, 30.394255],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 36,
    organizationID: '1260517766',
    title: 'На Мебельной',
    metro: ['Старая деревня'],
    address: 'ул. Мебельная, д. 1, корп. 2А',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.99089, 30.249447],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 37,
    organizationID: '1184434451',
    title: 'На Крестовском',
    metro: ['Крестовский остров'],
    address: 'пр. Крестовский, д. 24 Б',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.967795, 30.26214],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 38,
    organizationID: '1057859530',
    title: 'В Гатчине',
    metro: ['Нет метро'],
    address: 'ул. Генерала Кныша, д. 2 А',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.563501, 30.093113],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 39,
    organizationID: '1023398002',
    title: 'На Культуры',
    metro: ['Гражданский проспект'],
    address: 'пр. Культуры, д. 41, лит. А',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [60.053242, 30.389593],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 40,
    organizationID: '1058224079',
    title: 'На Ладожской',
    metro: ['Ладожская'],
    address: 'пл. Карла Фаберже, д. 8, лит. Е',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.934344, 30.437769],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 41,
    organizationID: '1038116145',
    title: 'На Комендантском',
    metro: ['Комендантский проспект'],
    address: 'пр. Комендантский, д. 2, лит. А',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [60.001073, 30.265877],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 42,
    organizationID: '1079600839',
    title: 'На Пискаревском',
    metro: ['Новочеркасская'],
    address: 'пр. Пискаревский, д. 25, лит. А',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.969574, 30.415294],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 43,
    organizationID: '1322699574',
    title: 'В Девяткино',
    metro: ['Девяткино'],
    address: 'ул. Главная, 60',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [60.058309, 30.483682],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 44,
    organizationID: '1038965370',
    title: 'На Савушкина',
    metro: ['Беговая', 'Старая деревня'],
    address: 'ул. Савушкина, д. 119, корп. 3',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.98793038601633, 30.228423182555545],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 45,
    organizationID: '1001745669',
    title: 'В Лахте',
    metro: ['Беговая'],
    address: 'пр. Лахтинский, д. 85',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.99446232539795, 30.147498751341935],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 46,
    organizationID: '50096030241',
    title: 'На Чкаловской',
    metro: ['Чкаловская'],
    address: 'ул. Б. Разночинная, д. 25 А',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '1Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.96135, 30.287068],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 47,
    organizationID: '1101760278',
    title: 'На Ленинском',
    metro: ['Ленинский проспект'],
    address: 'пр. Ленинский, д. 160, лит. А',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.85239296228268, 30.30156998413061],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 48,
    organizationID: '142391129149',
    title: 'На Пулковском',
    metro: ['Звёздная', 'Московская'],
    address: 'Шереметьевская ул., 13 литера А',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–23:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.806695, 30.320432],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 49,
    organizationID: '1138843698',
    title: 'Prestige на Хошимина',
    metro: ['Проспект Просвещения'],
    address: 'Выборгское шоссе, д. 15А',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–22:00',
    text:
      '2Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [60.052847, 30.311179],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
  {
    id: 50,
    organizationID: '1776880943',
    title: 'Prestige на Левашовском',
    metro: ['Чкаловская'],
    address: 'ул. Барочная, д. 10/2Б',
    pool: 'С бассейном',
    working: 'ПН-ПТ 07:00–23:00СБ-ВС 08:00–23:00',
    text:
      '3Светлый и просторный фитнес-клуб с большим бассейном для взрослых и детским бассейном. В клубе предусмотрены комфортные условия для семейного отдыха.',
    center: [59.967835846234024, 30.287162119049],
    poster: 'img/club/preview/1.jpg',
    href: 'club.html',
  },
];



const listMetro = [
  'Адмиралтейская',
  'Академическая',
  'Беговая',
  'Бухарестская',
  'Василеостровская',
  'Выборгская',
  'Гражданский проспект',
  'Девяткино',
  'Достоевская',
  'Звёздная',
  'Кировский завод',
  'Комендантский проспект',
  'Крестовский остров',
  'Купчино',
  'Ладожская',
  'Ленинский проспект',
  'Лесная',
  'Международная',
  'Московская',
  'Новочеркасская',
  'Озерки',
  'Пионерская',
  'Приморская',
  'Проспект Большевиков',
  'Проспект Ветеранов',
  'Проспект Просвещения',
  'Рыбацкое',
  'Старая деревня',
  'Удельная',
  'Улица Дыбенко',
  'Чкаловская',
  'Чёрная речка',
  'Нет метро',
];


ymaps.ready(['Panel']).then(function() {
  var map = new ymaps.Map('map', {
    center: [59.89444, 30.26417],
    zoom: 10,
    controls: ['zoomControl'],
  });

  // var rating = (club) => {
  //   ymaps.findOrganization(club).then(function(orgGeoObject) {
  //     // map.geoObjects.add(orgGeoObject);
  //     // orgGeoObject.balloon;
  //     var rating2 = orgGeoObject.properties.get('rating');
  //     console.log(rating2.ratings);
  //     return rating2.ratings;
  //   });
  // }

  // Создадим контент для меток.
  var createPrevieClub = club => {
    return (
      `
        <section class="club-preview">
        <div class="club-preview__header">
          <div class="club-preview__contacts">
            <div class="title">` +
      club.title +
      `</div>
            <div class="raiting">
            <iframe src="https://yandex.ru/sprav/widget/rating-badge/` +
      club.organizationID +
      `" width="150" height="50" frameborder="0"></iframe>
            </div>
            <div class="club-preview__address">` +
      club.address +
      `</div>
          </div>
          <div class="club-preview__working working-hours">
                          <div class="working-hours__club"><span>ПН-ПТ 07:00–23:00</span><span>СБ-ВС 08:00–22:00</span></div>
                        </div>
        </div>
        <div class="club-preview__body">
          <div class="club-preview__pic"><img src="` +
      club.poster +
      `" width="666" height="228px" alt="фитнес-клуб с&nbsp;большим бассейном"></div>
          <div class="club-preview__text">` +
      club.text +
      `</div>
        </div>
        <div class="club-preview__footer"><a class="link-text link-text--more" href="#modalToggle" data-bs-toggle="modal" data-toggle="modal"><span>Подобрать абонемент</span>
                      <svg class="icon" width="34" height="8" viewBox="0 0 34 8">
                        <use xlink:href="img/sprite.svg#arrow"></use>
                      </svg></a><a class="link-text link-text--more" href=` +
      club.href +
      `><span>О клубе</span>
                      <svg class="icon" width="34" height="8" viewBox="0 0 34 8">
                        <use xlink:href="img/sprite.svg#arrow"></use>
                      </svg></a></div>
      </section>
    `
    );
  };

  // Создадим и добавим панель на карту.
  var panel = new ymaps.Panel();
  map.controls.add(panel, {
    float: 'right',
  });
  // Создадим коллекцию геообъектов.
  var collection = new ymaps.GeoObjectCollection(null, {
    // Запретим появление балуна.
    hasBalloon: false,
    iconLayout: 'default#image',
    iconImageHref: 'img/icons/map-pin.svg',
    iconImageSize: [30, 42],
    iconImageOffset: [-5, -38],
  });
  // Добавим геообъекты в коллекцию.
  for (var i = 0; i < clubs.length; i++) {
    let myPlacemark = new ymaps.Placemark(
      clubs[i].center,
      {
        balloonContent: createPrevieClub(clubs[i]),
        iconImageHref: 'img/icons/map-pin.svg',
      },
    );
    collection.add(myPlacemark);

    myPlacemark.events
      .add('click', function (e) {
        e
          .get('target')
          .options.set({ iconImageHref: 'img/icons/map-pin-active.svg' });
      });
      // .add('click', function(e) {
      //   e
      //     .get('target')
      //     .options.unset({ iconImageHref: 'img/icons/map-pin.svg' });
      // });
  }

  // Добавим коллекцию на карту.
  map.geoObjects.add(collection);
  // Подпишемся на событие клика по коллекции.
  collection.events.add('click', function(e) {
    document.querySelector('.clubs-result').classList.add('d-none');
    // Получим ссылку на геообъект, по которому кликнул пользователь.
    var target = e.get('target');

    // Зададим контент боковой панели.
    panel.setContent(target.properties.get('balloonContent'));
    // Переместим центр карты по координатам метки с учётом заданных отступов.
    map.panTo(target.geometry.getCoordinates(), { useMapMargin: true });
  });

  map.behaviors.disable('scrollZoom');
});

