(function () {
   // header scroll
   const body = document.body;
  //  const triggerMenu = document.querySelector(".page-header__btn-burger");

   const scrollUp = "scroll-up";
   const scrollDown = "scroll-down";
   let lastScroll = 0;

  //  triggerMenu.addEventListener("click", () => {
  //    body.classList.toggle("menu-open");
  //    triggerMenu.classList.toggle("active");
  //  });

   window.addEventListener("scroll", () => {
     const currentScroll = window.pageYOffset;
     if (currentScroll <= 0) {
       body.classList.remove(scrollUp);
       return;
     }

     if (currentScroll > lastScroll && !body.classList.contains(scrollDown)) {
       // down
       body.classList.remove(scrollUp);
       body.classList.add(scrollDown);
     } else if (currentScroll < lastScroll && body.classList.contains(scrollDown)) {
       // up
       body.classList.remove(scrollDown);
       body.classList.add(scrollUp);
     }
     lastScroll = currentScroll;
   });
})()

// mob menu

export let mobileMenuToggle = () => {
  const page = document.querySelector('.page');
  const btnMenuOpen = document.querySelector('.page-header__btn-menu');
  const btnMenuOpenClose = document.querySelector('.mobile-menu__btn-close');
  const headerTop = document.querySelector('.page-header');
  const mobMenu = document.querySelector('.mobile-menu');

  if (btnMenuOpen) {
    btnMenuOpen.addEventListener('click', function() {
      headerTop.classList.add('page-header--mob');
      page.classList.add('page--overlay');
      mobMenu.classList.add('active');
    });
  }

  if (btnMenuOpenClose) {
    btnMenuOpenClose.addEventListener('click', function() {
      headerTop.classList.remove('page-header--mob');
      page.classList.remove('page--overlay');
      mobMenu.classList.remove('active');
    });
  }

  if (mobMenu) {
    mobMenu.addEventListener('click', () => {
      mobMenu.classList.remove('active');
    });
  }

  window.onresize = function() {
    if (window.screen.width > 768) {
      document.querySelector('.page').classList.remove('page--overlay');
      if (headerTop.classList.contains('page-header--mob')) {
        headerTop.classList.remove('page-header--mob');
      }
    }
  };
};



mobileMenuToggle();



// расписание
var daysWeek = ['вс', 'пн', 'вт', 'ср', 'чт', 'пт', 'сб'];
var daysWeekMob = [
  'Воскресенье',
  'Понедельник',
  'Вторник',
  'Среда',
  'Четверг',
  'Пятница',
  'Суббота',
];
let nowDateSlice = new Date().toLocaleDateString().slice(0, -5);
let nowDate = new Date();
let nowDayWeek = nowDateSlice + ' ' + daysWeek[nowDate.getDay()];
let nowDayWeekMob = nowDateSlice + ' ' + daysWeekMob[nowDate.getDay()];

console.log(nowDayWeekMob);

const weekDays = document.querySelector('.week-days');
const scheduleDays = document.querySelector('.schedule__days');
const scheduleBtn = document.querySelector('.schedule__button');
const hours = document.querySelector('.hours');
const hoursItems = document.querySelectorAll('.hours__item');
const weekDaysItems = document.querySelectorAll('.week-days__item');
let activeDay = document.querySelector('.schedule__item-active');

const days = document.querySelectorAll('[data-weekday]');

if (window.matchMedia('(max-width: 767px)').matches) {
  activeDay.innerText = nowDayWeek;
  mobActiveDay(nowDayWeek);
}

function onMenuClose() {
  scheduleBtn.classList.remove('schedule__button--open');
  weekDays.classList.remove('week-days--open');
  // scheduleDays.classList.remove('schedule__days--close');
  hours.classList.remove('hours--opacity');
}

function activeHoursItem(hourText) {
  hoursItems.forEach(function(item) {
    if (item.innerText === hourText) {
      item.classList.add('hours__item--active');
    }
  });
}

function activeWeekDay(weekDayText) {
  weekDaysItems.forEach(function(item) {
    if (item.innerText === weekDayText) {
      item.classList.add('week-days__item--active');
      activeDay.classList.add('schedule__item-active--active');
    }
  });
}

function noActiveHoursItem(hourText) {
  hoursItems.forEach(function(item) {
    if (item.innerText === hourText) {
      item.classList.remove('hours__item--active');
    }
  });
}

function noActiveWeekDay(weekDayText) {
  weekDaysItems.forEach(function(item) {
    if (item.innerText === weekDayText) {
      item.classList.remove('week-days__item--active');
      activeDay.classList.remove('schedule__item-active--active');
    }
  });
}

function mobMenuToogle() {
  scheduleBtn.classList.toggle('schedule__button--open');
  weekDays.classList.toggle('week-days--open');
  // scheduleDays.classList.toggle('schedule__days--close');
  hours.classList.toggle('hours--opacity');
}

function mobActiveDay(day) {
  var days = document.querySelectorAll('.days');
  days.forEach(function(item) {
    item.classList.add('days--hidden');
    console.log(item.getAttribute('data-weekDay'));
    console.log(day);

    if (item.getAttribute('data-weekDay') === day) {
      item.classList.remove('days--hidden');
    }
  });
}

function mobWeekDays() {
  weekDaysItems.forEach(function(item) {
    item.addEventListener('click', function() {
      var day = item.innerText;
      activeDay.innerText = '';
      activeDay.innerText = day;

      mobActiveDay(day);

      onMenuClose();
    });
  });
}

const daysItems = document.querySelectorAll('.days__item');

daysItems.forEach(function(item) {
  item.addEventListener('mouseover', function() {
    let hourText = item.getAttribute('data-hour');
    let weekDayText = item.parentElement.getAttribute('data-weekDay');

    activeHoursItem(hourText);

    activeWeekDay(weekDayText);

    item.classList.add('days__item--active');
  });

  item.addEventListener('mouseout', function() {
    let hourText = item.getAttribute('data-hour');
    let weekDayText = item.parentElement.getAttribute('data-weekDay');

    noActiveHoursItem(hourText);

    noActiveWeekDay(weekDayText);

    item.classList.remove('days__item--active');
  });
});

if (scheduleBtn) {
  scheduleBtn.addEventListener('click', function(evt) {
    evt.preventDefault();

    mobMenuToogle();

    if (weekDays.classList.contains('week-days--open')) {
      mobWeekDays();
    }
  });
}



document.querySelectorAll('.lesson').forEach(item => {
  var popover = new bootstrap.Popover(item, {

    popperConfig: function(defaultBsPopperConfig) {
      // var newPopperConfig = {...}
      // use defaultBsPopperConfig if needed...
      // return newPopperConfig
    },
  });
});

const list = [].slice.call(
  document.querySelectorAll('[data-bs-toggle="popover"]'),
);
list.map(el => {
  let opts = {
    html: true,
    animation: false,
    content: $('[data-name="popover-content"]'),
  };
  if (el.hasAttribute('data-bs-content-id')) {
    opts.content = document.getElementById(
      el.getAttribute('data-bs-content-id'),
    ).innerHTML;
    opts.html = true;
  }
  new bootstrap.Popover(el, opts);
});


