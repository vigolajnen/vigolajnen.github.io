jQuery(document).ready((function(e){var t="webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",n=e(".csstransitions").length>0;function a(e){this.element=e,this.timeline=this.element.find(".timeline"),this.timelineItems=this.timeline.find("li"),this.timelineItemsNumber=this.timelineItems.length,this.timelineStart=d(this.timelineItems.eq(0).text()),this.timelineUnitDuration=d(this.timelineItems.eq(1).text())-d(this.timelineItems.eq(0).text()),this.eventsWrapper=this.element.find(".events"),this.eventsGroup=this.eventsWrapper.find(".events-group"),this.singleEvents=this.eventsGroup.find(".single-event"),this.eventSlotHeight=this.eventsGroup.eq(0).children(".top-info").outerHeight(),this.modal=this.element.find(".event-modal"),this.modalHeader=this.modal.find(".header"),this.modalHeaderBg=this.modal.find(".header-bg"),this.modalBody=this.modal.find(".body"),this.modalBodyBg=this.modal.find(".body-bg"),this.modalMaxWidth=800,this.modalMaxHeight=480,this.animating=!1,this.initSchedule()}n||(t="noTransition"),a.prototype.initSchedule=function(){this.scheduleReset(),this.initEvents()},a.prototype.scheduleReset=function(){var e=this.mq();"desktop"!=e||this.element.hasClass("js-full")?"mobile"==e&&this.element.hasClass("js-full")?(this.element.removeClass("js-full loading"),this.eventsGroup.children("ul").add(this.singleEvents).removeAttr("style"),this.eventsWrapper.children(".grid-line").remove(),this.element.hasClass("modal-is-open")&&this.checkEventModal()):"desktop"==e&&this.element.hasClass("modal-is-open")?(this.checkEventModal("desktop"),this.element.removeClass("loading")):this.element.removeClass("loading"):(this.eventSlotHeight=this.eventsGroup.eq(0).children(".top-info").outerHeight(),this.element.addClass("js-full"),this.placeEvents(),this.element.hasClass("modal-is-open")&&this.checkEventModal())},a.prototype.initEvents=function(){var t=this;this.singleEvents.each((function(){var n='<span class="event-date">'+e(this).data("start")+" - "+e(this).data("end")+"</span>";e(this).children("a").prepend(e(n)),e(this).on("click","a",(function(n){n.preventDefault(),t.animating||t.openModal(e(this))}))})),this.modal.on("click",".close",(function(e){e.preventDefault(),t.animating||t.closeModal(t.eventsGroup.find(".selected-event"))})),this.element.on("click",".cover-layer",(function(e){!t.animating&&t.element.hasClass("modal-is-open")&&t.closeModal(t.eventsGroup.find(".selected-event"))}))},a.prototype.placeEvents=function(){var t=this;this.singleEvents.each((function(){var n=d(e(this).attr("data-start")),a=d(e(this).attr("data-end"))-n,i=t.eventSlotHeight*(n-t.timelineStart)/t.timelineUnitDuration,o=t.eventSlotHeight*a/t.timelineUnitDuration;e(this).css({top:i-1+"px",height:o+1+"px"})})),this.element.removeClass("loading")},a.prototype.openModal=function(a){var i=this,o=i.mq();if(this.animating=!0,this.modalHeader.find(".event-name").text(a.find(".event-name").text()),this.modalHeader.find(".event-date").text(a.find(".event-date").text()),this.modal.attr("data-event",a.parent().attr("data-event")),this.modalBody.find(".event-info").load(a.parent().attr("data-content")+".html .event-info > *",(function(e){i.element.addClass("content-loaded")})),this.element.addClass("modal-is-open"),setTimeout((function(){a.parent("li").addClass("selected-event")}),10),"mobile"==o)i.modal.one(t,(function(){i.modal.off(t),i.animating=!1}));else{var s=a.offset().top-e(window).scrollTop(),l=a.offset().left,d=a.innerHeight(),c=a.innerWidth(),m=e(window).width(),h=e(window).height(),u=.8*m>i.modalMaxWidth?i.modalMaxWidth:.8*m,p=.8*h>i.modalMaxHeight?i.modalMaxHeight:.8*h,v=parseInt((m-u)/2-l),g=parseInt((h-p)/2-s),f=p/d,y=u-c;i.modal.css({top:s+"px",left:l+"px",height:p+"px",width:u+"px"}),r(i.modal,"translateY("+g+"px) translateX("+v+"px)"),i.modalHeader.css({width:c+"px"}),i.modalBody.css({marginLeft:c+"px"}),i.modalBodyBg.css({height:d+"px",width:"1px"}),r(i.modalBodyBg,"scaleY("+f+") scaleX("+y+")"),i.modalHeaderBg.css({height:d+"px",width:c+"px"}),r(i.modalHeaderBg,"scaleY("+f+")"),i.modalHeaderBg.one(t,(function(){i.modalHeaderBg.off(t),i.animating=!1,i.element.addClass("animation-completed")}))}n||i.modal.add(i.modalHeaderBg).trigger(t)},a.prototype.closeModal=function(a){var i=this,o=i.mq();if(this.animating=!0,"mobile"==o)this.element.removeClass("modal-is-open"),this.modal.one(t,(function(){i.modal.off(t),i.animating=!1,i.element.removeClass("content-loaded"),a.removeClass("selected-event")}));else{var s=a.offset().top-e(window).scrollTop(),l=a.offset().left,d=a.innerHeight(),c=a.innerWidth(),m=Number(i.modal.css("top").replace("px","")),h=l-Number(i.modal.css("left").replace("px","")),u=s-m;i.element.removeClass("animation-completed modal-is-open"),this.modal.css({width:c+"px",height:d+"px"}),r(i.modal,"translateX("+h+"px) translateY("+u+"px)"),r(i.modalBodyBg,"scaleX(0) scaleY(1)"),r(i.modalHeaderBg,"scaleY(1)"),this.modalHeaderBg.one(t,(function(){i.modalHeaderBg.off(t),i.modal.addClass("no-transition"),setTimeout((function(){i.modal.add(i.modalHeader).add(i.modalBody).add(i.modalHeaderBg).add(i.modalBodyBg).attr("style","")}),10),setTimeout((function(){i.modal.removeClass("no-transition")}),20),i.animating=!1,i.element.removeClass("content-loaded"),a.removeClass("selected-event")}))}n||i.modal.add(i.modalHeaderBg).trigger(t)},a.prototype.mq=function(){return window.getComputedStyle(this.element.get(0),"::before").getPropertyValue("content").replace(/["']/g,"")},a.prototype.checkEventModal=function(t){this.animating=!0;var n=this,a=this.mq();if("mobile"==a)n.modal.add(n.modalHeader).add(n.modalHeaderBg).add(n.modalBody).add(n.modalBodyBg).attr("style",""),n.modal.removeClass("no-transition"),n.animating=!1;else if("desktop"==a&&n.element.hasClass("modal-is-open")){n.modal.addClass("no-transition"),n.element.addClass("animation-completed");var i=n.eventsGroup.find(".selected-event"),o=(i.offset().top,e(window).scrollTop(),i.offset().left,i.innerHeight()),s=i.innerWidth(),l=e(window).width(),d=e(window).height(),c=.8*l>n.modalMaxWidth?n.modalMaxWidth:.8*l,m=.8*d>n.modalMaxHeight?n.modalMaxHeight:.8*d,h=m/o,u=c-s;setTimeout((function(){n.modal.css({width:c+"px",height:m+"px",top:d/2-m/2+"px",left:l/2-c/2+"px"}),r(n.modal,"translateY(0) translateX(0)"),n.modalBodyBg.css({height:m+"px",width:"1px"}),r(n.modalBodyBg,"scaleX("+u+")"),n.modalHeader.css({width:s+"px"}),n.modalBody.css({marginLeft:s+"px"}),n.modalHeaderBg.css({height:o+"px",width:s+"px"}),r(n.modalHeaderBg,"scaleY("+h+")")}),10),setTimeout((function(){n.modal.removeClass("no-transition"),n.animating=!1}),20)}};var i=e(".cd-schedule"),o=[],s=!1;function l(){o.forEach((function(e){e.scheduleReset()})),s=!1}function d(e){var t=(e=e.replace(/ /g,"")).split(":");return 60*parseInt(t[0])+parseInt(t[1])}function r(e,t){e.css({"-moz-transform":t,"-webkit-transform":t,"-ms-transform":t,"-o-transform":t,transform:t})}i.length>0&&i.each((function(){o.push(new a(e(this)))})),e(window).on("resize",(function(){s||(s=!0,window.requestAnimationFrame?window.requestAnimationFrame(l):setTimeout(l))})),e(window).keyup((function(e){27==e.keyCode&&o.forEach((function(e){e.closeModal(e.eventsGroup.find(".selected-event"))}))}))})),function(){const e=document.body,t="scroll-up",n="scroll-down";let a=0;window.addEventListener("scroll",(()=>{const i=window.pageYOffset;i<=0?e.classList.remove(t):(i>a&&!e.classList.contains(n)?(e.classList.remove(t),e.classList.add(n)):i<a&&e.classList.contains(n)&&(e.classList.remove(n),e.classList.add(t)),a=i)}))}();export let mobileMenuToggle=()=>{const e=document.querySelector(".page"),t=document.querySelector(".page-header__btn-menu"),n=document.querySelector(".mobile-menu__btn-close"),a=document.querySelector(".page-header"),i=document.querySelector(".mobile-menu");t&&t.addEventListener("click",(function(){a.classList.add("page-header--mob"),e.classList.add("page--overlay"),i.classList.add("active")})),n&&n.addEventListener("click",(function(){a.classList.remove("page-header--mob"),e.classList.remove("page--overlay"),i.classList.remove("active")})),i&&i.addEventListener("click",(()=>{i.classList.remove("active")})),window.onresize=function(){window.screen.width>768&&(document.querySelector(".page").classList.remove("page--overlay"),a.classList.contains("page-header--mob")&&a.classList.remove("page-header--mob"))}};mobileMenuToggle(),function(){let e=["Санкт-Петербург","Нижний Новгород","Казань","Тольятти","Самара","Ульяновск","Архангельск","Ижевск","Ярославль","Петрозаводск","Мурманск","Рязань","Набережные Челны","Тула","Нижнекамск"].filter((e=>"Санкт-Петербург"!==e)).sort();e.unshift("Санкт-Петербург");let t=[...document.querySelectorAll(".city-list li button")],n=[...document.querySelectorAll(".nav-city__list li a")];for(let a=0;a<e.length;a++){for(let n=0;n<t.length;n++)n==a&&(t[n].innerText=e[a]);for(let t=0;t<n.length;t++)t==a&&(n[t].innerText=e[a])}document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".nav-city__title"),t=document.querySelector(".nav-city__title span"),n=document.querySelector(".nav-city__wrapper"),a=document.querySelector(".nav-city__wrapper.d-block"),i=()=>{n.classList.toggle("d-block"),n.classList.toggle("d-none")};e&&e.addEventListener("click",(e=>{e.stopPropagation(),i()})),document.addEventListener("click",(t=>{let a=t.target,o=a==n||n.contains(a),s=a==e,l=n.classList.contains("d-block");o||s||!l||i()})),n&&n.addEventListener("click",(e=>{if(e.preventDefault(),"A"==e.target.tagName){let n=e.target.innerText;t.innerText=n,i()}})),a&&page.addEventListener("click",(()=>{i()}))}))}();const e=document.querySelector("#modalToggle"),t=document.querySelector(".definition-city");t&&t.addEventListener("click",(()=>{t.classList.add("d-none")})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".nav-city__title");let t=document.querySelector(".nav-menu"),n=document.createElement("div"),a=document.createElement("div"),i=document.createElement("button"),o=document.createElement("button");n.className="location",a.className="location__title",i.className="button active",o.className="button",a.innerText="Ваш город Санкт-Петербург?",i.innerText="Да",o.innerText="Нет",o.setAttribute("data-bs-target","#modalToggleCityChange"),o.setAttribute("data-bs-toggle","modal"),o.setAttribute("data-bs-dismiss","modal"),n.append(a),n.appendChild(i),n.appendChild(o),setTimeout((()=>{t.append(n);const a=document.querySelector(".location"),i=document.querySelector(".nav-city__title span"),o=document.querySelector(".city-list");a&&(a.addEventListener("click",(e=>{let t=e.target;"BUTTON"==t.tagName&&"Да"==t.innerText?(i.innerText="Санкт-Петербург",n.remove()):(e.target.previousElementSibling.classList.toggle("active"),e.target.classList.toggle("active"),o&&o.addEventListener("click",(e=>{let t=e.target;t.classList.toggle("active"),"BUTTON"==t.tagName&&(i.innerText=t.innerText,n.remove())})))})),e&&e.addEventListener("click",(e=>{n.remove()})))}))})),function(){"use strict";let e=document.querySelectorAll(".needs-validation"),t=document.querySelector(".modal-tour"),n=document.getElementById("modal-submit-form");if(t){const a=new bootstrap.Modal(t);Array.prototype.slice.call(e).forEach((function(e){e.addEventListener("submit",(function(t){if(e.checkValidity()){t.preventDefault(),e.classList.remove("was-validated");const i=new bootstrap.Modal(n);a.hide(),i.show(),n.addEventListener("hidden.bs.modal",(function(){e.submit(),e.reset()}))}else t.preventDefault(),t.stopPropagation(),e.classList.add("was-validated")}),!1)}))}else Array.prototype.slice.call(e).forEach((function(e){e.addEventListener("submit",(function(t){if(e.checkValidity()){t.preventDefault(),e.classList.remove("was-validated");new bootstrap.Modal(n).show(),n.addEventListener("hidden.bs.modal",(function(){e.submit(),e.reset()}))}else t.preventDefault(),t.stopPropagation(),e.classList.add("was-validated")}),!1)}))}();